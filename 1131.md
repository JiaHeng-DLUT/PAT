# 1131

- [1131 Subway Map (30 point(s))](https://pintia.cn/problem-sets/994805342720868352/problems/994805347523346432)

```c++
#include <iostream>
#include <algorithm>
#include <map>
#include <vector>
using namespace std;

int N;
const int MAX_N = 100 + 5;
vector<int> line[MAX_N];
vector<int> station[10000 + 5];
int K;
const int MAX_K = 10 + 5;
int S, D;
bool vis[10000 + 5] = { 0 };
vector<pair<int, int>> res;

void dfs(int s) {
	cout << s << endl;
	if (s == D) {
		return;
	}
	vis[s] = 1;
	for (int i = 0; i < station[s].size(); i++) {
		int nextLine = station[s][i];
		int nextStationIndex = find(line[nextLine].begin(), line[nextLine].end(), s) - line[nextLine].begin() + 1;
		if (nextStationIndex < line[nextLine].size()) {
			int nextStation = line[nextLine][nextStationIndex];
			if (!vis[nextStation]) {
				dfs(nextStation);
				res.push_back(make_pair(nextStation, nextLine));
			}
			else {
				res.pop_back();
			}
		}
		else {
			res.pop_back();
		}
	}
	cout << endl;
}

int main() {
	cin >> N;
	for (int n = 1; n <= N; n++) {
		int M;
		cin >> M;
		for (int m = 0; m < M; m++) {
			int s;
			cin >> s;
			line[n].push_back(s);
			station[s].push_back(n);
		}
	}
	cin >> K;
	for (int k = 0; k < K; k++) {
		cin >> S >> D;
		fill(vis, vis + 10000 + 5, 0);
		dfs(S);
		for (auto it : res) {
			cout << it.first << " " << it.second << endl;
		}
	}
	return 0;
}

/*
Sample Input:
4
7 1001 3212 1003 1204 1005 1306 7797
9 9988 2333 1204 2006 2005 2004 2003 2302 2001
13 3011 3812 3013 3001 1306 3003 2333 3066 3212 3008 2302 3010 3011
4 6666 8432 4011 1306
3
3011 3013
6666 2001
2004 3001
Sample Output:
2
Take Line#3 from 3011 to 3013.
10
Take Line#4 from 6666 to 1306.
Take Line#3 from 1306 to 2302.
Take Line#2 from 2302 to 2001.
6
Take Line#2 from 2004 to 1204.
Take Line#1 from 1204 to 1306.
Take Line#3 from 1306 to 3001.
*/

```

## References

